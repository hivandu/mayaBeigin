---
layout: post
title: 第六章第二节 使用Trax Editor
categories:
- Maya
tags:
- Maya
- trax editor
- 开始maya吧
- 第六章
published: true
comments: true
---
<p><!--more--></p>

<p><a href="http://hivan.me/2008/03/20/begin-maya.html" target="_blank">回章目录选择</a></p>

<p><a href="http://hivan.me/2008/03/22/sixth-non-linear-animation.html" target="_blank">回节目录选择</a>
<h5>本节概述</h5>
本节主要讲解如何在Trax Editor中制作非线性动画的方法。
<h5>了解Trax Editor</h5>
选择Window &gt; Trax Editor，显示Trax Editor 视窗，下面我们了解一下Trax Editor 视窗中的几个组成部分，如图6.2.1所示。</p>

<p><a title="image001" href="http://www.flickr.com/photos/95019520@N00/2352363840/" target="_blank"><img src="http://static.flickr.com/2221/2352363840_8626decf72.jpg" border="0" alt="image001" /></a></p>

<p>图6.2.1</p>

<p>Trax 编辑器视窗的左侧列出了场景中的角色和子角色，视窗的右侧显示了时间栏和包含所创建的动画片段的轨道。只有已在场景中创建了角色，才会在Trax 编辑器中看到角色和轨道。</p>

<p>用户可以在一个或多个轨道上用一个或多个片段动画角色。一个轨道上可以有多个按序排好的片段。在播放场景时，片段从左向右播放。如果一个角色有多个轨道，Maya 会使用轨道上的所有片段。重叠的片段有相加的效果。用户可以融合叠加的片段来避免双倍的运动。用户可以选择Create &gt; Character 命令来在Trax 编辑器中创建一个角色。此选项与主菜单中的Character &gt; Create 命令是相同的。
<h5>创建片段</h5>
在动画一个角色之后，用户可以为动画的每个部分创建一个片段。
<h6>创建一个片段：</h6>
1 选择角色。</p>

<p>2 在Trax 编辑器中，选择Create &gt; Clip ，显示选项视窗。也可以从主菜单中选择Animate &gt; Create Clip，显示选项视窗。</p>

<p>3 设置下列选项，并单击Create Clip 按钮。</p>

<p><strong>Name </strong>为片段命名。默认名为“clipn”。</p>

<p><strong>Keys Leave Keys in Timeline </strong>把关键帧置于时间滑块的时间栏里，并把片段放进Visor 视窗里。如果目前还用不到这些片段，但想保存起来以后再用，这一选项是非常用的。如果关键帧仍然保留在时间滑块上，用户可以使用这些关键帧来创建其它片段。关闭Leave Keys in Timeline 项后，用户可以选择把片段只放在Visor 中，还是放在Visor 和Trax 编辑器。如果当前要编辑片段，需要把片段放在编辑器中。关闭Leave Keys in Timeline 后，不能用时间栏里原来的关键帧创建角色的片段了。Maya 会去除关键帧并清空时间栏，这样用户可以创建一个新的片段。如果想创建角色动画中几个不同时间范围的片段，关闭Leave Keys inTimeline 并打开Put Clip in Trax Editor and Visor 即可。创建一个包括所有需要的关键帧的片段，然后把片段分成几段想要的动画片段。</p>

<p>注意：如果打开Leave Keys in Timeline，则Put Clip in Trax Editor and Visor 选项会失效以防止时间滑块中的关键帧被添加到Trax 中的片段动画中，这可以避免产生叠加的动画效果。如果为角色创建了一个片段，然后在时间滑块的时间栏里设置关键帧，则关键帧动画就被添加到片段动画中，这称为运动扭曲或非破坏性动画。</p>

<p><strong>Clip </strong>指定把创建的角色放置在何处。如果现在不想使用片段，但想保存起来以后使用，可以选择<strong>Put Clip in Visor Only</strong>。选择<strong>Put Clip in Trax Editor and Visor</strong>，可以直接在Trax 编辑器中对片段进行操作。此选项是默认设置。</p>

<p><strong>Time Range </strong>设置在Trax 编辑器定片段的时间范围。</p>

<p><strong>Use Selected </strong>项则片段使用时间栏里选择的时间范围。按下Shift 键，在时间滑块的时间栏里拖动来选择时间范围。</p>

<p><strong>Use Time Slider Range </strong>项则片段使用时间栏开始时间和结束时间之间的范围作为时间范围。</p>

<p><strong>Use Animation Curve Range </strong>项使用角色动画曲线的范围作为时间范围。也就是说开始时间是角色中首帧的时间，结束时间就是最末帧的时间。</p>

<p><strong>Specify Start and End </strong>项使用在开始和结束栏里输入的时间范围作为时间范围。</p>

<p><strong>Start and End </strong>如果Specify Start and End 处于打开状态下，可以指定片段的开始和结束时间。</p>

<p><strong>Subcharacters </strong>选择<strong>Include Subcharacters in Clip </strong>则除了角色的动画外，还包括所有子角色的动画。
<h6>编辑片段属性：</h6>
1 在Trax Editor 视窗中，单击片段来选中它。</p>

<p>2 在Trax Editor 视窗中，选择Modify &gt; Attribute Editor。</p>

<p>则下列属性会显示：
<h6>Anim Clip Attributes</h6>
<strong>Weight </strong>输入百分数，按比例缩小和扩大片段中每个属性的参数值。缩放对片段的整个动画都起作用。例如，假设物体的translateX 属性的数值在30帧上从10 增加20。如果把权重设置为0.5，则translateX 属性值在30帧上从10 增加到15。所有的属性数据类型，除了布尔属性，都会受到权重属性的影响。</p>

<p><strong>Offset </strong>如果片段是由上一个片段或由时间栏里的关键帧控制，则此项设置Maya 如何插值片段的属性数值。</p>

<p><strong>Absolute </strong>使用属性的片段数值，无论其以前的数值。</p>

<p><strong>Relative </strong>添加属性的片段数值到它以前的数值中。</p>

<p>例如，假设创建了两个片段，第一个片段是角色沿X 轴走着离开原点，第二个片段是角色沿着X 轴跑着离开原点。</p>

<p>如果Relative 处于打开状态，角色会先从原点沿X 轴走开，然后角色开始跑，开始跑的位置也就是角色走片段的结束处。如果Absolute 处于打开状态下，角色会从原点走开，当到达行走片段的末端时，角色会立即移到原点，然后从原点处开始跑。</p>

<p>如果同一角色两个片段分别在不同通道上并且是重叠的，则不管是使用Absolute 还是使用Relative，Maya 会把两个属性的数值相加。这种叠加效果通常是不可取的，除非用户想混合片段。</p>

<p><strong>Enable </strong>禁止一个片段则关闭了由此片段控制的动画，Enabling 则打开了正常的动画。通常对于某些当前不需要编辑的片段，为了减少动画的杂乱，则使用此项。</p>

<p><strong>Start Frame </strong>设置片段播放的开始时间，也可以在Trax Editor 视窗中左右拖动片段来改变播放的开始时间。</p>

<p><strong>Cycle </strong>用于指定片段重复的次数。例如片段原播放10 帧，如果参数值为2，会使片段播放20 帧。如果参数值为0.5，会使片段播放5 帧。如果参数值大于1，片段显示一个小标尺类的标记，显示附加片段循环开始的位置。</p>

<p>用户可以输入循环参数值，也可以拖拽片段右下部的边缘，增大或减少参数值。当拖拉边缘时，下列图标会显示在片段中。</p>

<p><strong>Scale </strong>延长或缩短片段播放的时间范围。如果用户增加了片段播放的时间，属性的动画会变慢，如果缩短片段播放的时间，会使动画的变快。用户可以拖拉片段的上部的右边缘，改变Scale 的参数值。。
<h6>Source Clip Attributes（源片段的属性）</h6>
<h6>Node Behavior（节点行为）</h6>
此处包含了几个不常用的属性，详细信息请参看使用<em>Maya: Essentials </em>来了解细节。
<h6>Extra Attributes（附加属性）</h6>
在默认状态下没有附加选项。
<h6>技巧</h6>
使用Trax 编辑器顶部的菜单项目的另一个方法是：右键单击片段，显示可应用到片段上的可用菜单。</p>

<p>编辑源片段属性</p>

<p>当创建片段时，Maya 在Visor 视窗中以名称为clipnSource 的节点保存选择角色的整个动画曲线。在Trax Editor 视窗中的片段是源片段的实例。Trax 编辑器中的片段可以是源片段的一部分，也可以是整个源片段。用户可以编辑源片段的几个属性，例如当创建片段时，选择的开始时间。例如在1 帧到100帧间，创建了一个蓝球运动员拍球数次，然后投篮的动画。那么可以先创建一个片段，这个片段是从第30 帧到第50 帧，是球员拍球的动画。如果想延伸片段到球员投篮，这时不能在Trax 编辑器中扩展片段，必须在源片段中修改Start 属性，得到想要的结果。</p>

<p>注意当修改源片段的属性时，会修改Trax 编辑器使用此源片段的所有片段。
<h6>编辑源片段的属性：</h6>
1 在Trax 编辑器中，右击片段，并从弹出菜单中选择Select Clip Source 命令。</p>

<p>2 在Trax 编辑器中选择Modify &gt; Attribute Editor 命令。</p>

<p>则下列属性会显示：
<h6>Anim Clip Attributes（动画片段属性）</h6>
此区域呈灰色显示，因为此属性不使用于源片段中。
<h6>Source Clip Attributes （源片段属性）</h6>
<strong>Pose </strong>（姿势属性） 如果为角色创建的姿势，而不是创建片段，当打开属性编辑器时，属性编辑器的Pose（姿势）选项会被选中。此选项指示此片段是姿势，而不是动画片段。</p>

<p><strong>Start </strong>指定源片段的开始时间。</p>

<p><strong>Duration </strong>指定片段从Start 开始扩展的时间量。
<h6>Node Behavior</h6>
此处包含了几个片段中不常用的属性，详细信息参看使用<em>Maya: Essentials </em>来了解细节。
<h6>Extra Attributes</h6>
在默认状态下，没有附加选项。
<h6>剪切，拷贝和粘贴片段</h6>
用户可以从Trax Editor 视窗中剪切或拷贝一个片段，也可以在Visor 视窗中拷贝片段。对片段进行了拷贝或剪切后，可以将其粘贴到同一个角色上，或粘贴到有类似属性的不同角色上。</p>

<p>如果用户拷贝片段并把它粘贴到同一个角色上，用户为片段创建了一个播放实例。如果用户拷贝片段并把它粘贴到新的角色上，则用户创建了一个片段复制。</p>

<p>注意不能把片段粘贴到一个选择的片段上来替换它。用户必须删除不需要的片段，然后拷贝和粘贴需要的片段到角色上，然后移动片段到需要的位置上。</p>

<p>当把片段从一个角色上拷贝粘贴到另一个角色上时，两角色的物体或属性最好相同。如果两角色中的物体或属性不同，在进行片段的拷贝粘贴操作时，还需要操作一些其它的步骤。
<h6>剪切片段：</h6>
1 选择片段。</p>

<p>2 在Trax 编辑器中，选择Edit &gt; Cut 命令。
<h6>在Trax Editor 视窗中拷贝片段：</h6>
1 选择片段。</p>

<p>2 在Trax 编辑器中选择Edit &gt; Copy。
<h6>粘贴片段到同一个角色上：</h6>
1 选择角色。</p>

<p>2 在Trax 编辑器中，选择Edit&gt;Paste 命令。
<h6>将片段粘贴到不同角色上</h6>
1 选择角色。</p>

<p>2 在Trax 编辑器中选择Edit &gt; Paste 。</p>

<p>3 设置下列属性，单击Paste Clip 按钮。</p>

<p><strong>Paste Method </strong>（粘贴方法）</p>

<p><strong>By Attribute Name </strong>粘贴属性的数值到接受角色中名称匹配的属性上。这时不会考虑物体的名称。</p>

<p><strong>By Attribute Order </strong>根据属性在通道盒中的排列顺序，把属性参数粘贴到接受角色上。</p>

<p><strong>By Node Name </strong>把属性数值粘贴到接受角色中名称匹配的物体或属性上。</p>

<p><strong>By Current Map </strong>当进行角色映射的输出和编辑（输出和编辑角色映射）时，会用到这一选项。
<h6>在Visor 视窗中拷贝片段，并把其粘贴到Trax Editor 视窗中</h6>
1 在Trax 编辑器中，选择File &gt; Visor。</p>

<p>2 从Visor 中，用鼠标中键拖动片段到需要的轨道和位置上。Maya 把片段放置在鼠标单击的位置处。如果在鼠标单击处有片段占据，Maya 会把片段放置到下面第一个有效的轨道上，如果必要Maya 会添加轨道。</p>

<p>如果用户使用鼠标中键把某个角色的片段拖动到Trax 编辑器中自身之上，Maya 创建片段的实例。</p>

<p>如果用鼠标中键拖动片段到另一个角色上，并且以前在两角色间创建了角色映射，Maya会使用角色映射来粘贴片段，否则使用By NodeName 粘贴方式来粘贴片段。如果用户想要使用不同于By Attribute Name 的方式粘贴片段，在Visor 视窗中右键单击片段，并选择Copy，然后使用Edit &gt; Paste 命令，并选择合适的方式。
<h6>复制片段</h6>
用户可以复制片段，来创建源片段及其动画曲线的拷贝。如果用户创建了一个复制，用户可修改源片段的动画，而不会影响片段的拷贝。</p>

<p>例如，假设创建了一个跳动的片段，我们想保留这一片段，同时又想在这个片段的基础上，对跳动稍做改动。那么首先需要复制源片段，然后激活复制片段的关键帧，修改它们来创建新的跳动效果。这种操作不会影响原始的跳动片段或任何它的实例。</p>

<p>一个源片段只能用于一个角色，因此不能复制源片段，将其用于多个角色上。如果想在其它角色上使用源片段的拷贝，用户必须从一个角色上拷贝并把它粘贴到另一个角色上。
<h6>设置复制片段选项：</h6>
1 在Trax 编辑器中，选择Edit &gt; Duplicate 命令。</p>

<p>2 设置下列选项，并单击Duplicate Clip 按钮。</p>

<p><strong>Clip</strong> 设置片段拷贝的位置。</p>

<p><strong>Put Clip in Visor Only</strong> 如果现在不想使用片段，而想把片段保存起来留待以后使用，可以选择这一选项。</p>

<p><strong>Put Clip in Trax Editor and Visor</strong> 使用这一选项，用户可以当前在Trax 编辑器中对片段进行操作。Maya 把片段的播放实例放置在Trax 编辑器的当前时间位置处。此项是默认设置。
<h6>实例片段</h6>
如果用户在Trax Editor 视窗中选择一个片段，并实例它，则结果的片段使用选择片段的源片段的动画曲线。如果用户修改源片段的动画，则会同时影响实例片段。对于相同的动画，与其创建几个不同的源片段，实例片段使用更少的内存。
<h6>实例片段：</h6>
1 在Trax Editor 视窗中，选择要进行实例的片段。</p>

<p>2 在Trax Editor 视窗中，选择Edit &gt; Instance。</p>

<p>用户也可以使用鼠标中键把Visor 视窗中的源片段拖动到Trax Editor 视窗中的同一角色上来创建片段实例。
<h6>分离片段</h6>
可以对片段进行分离操作，把角色的动画分离成多个可重复使用的片段。例如，假设一个角色完成了以下三个操作：空手道猛击，踢腿和空翻。可以把此片段分成三个部分，然后重新排列这些片段。
<h6>设置分离片段选项：</h6>
1 在Trax 编辑器中，选择Edit &gt; Split 。</p>

<p>2 设置下列选项，并单击Split Clip 按钮。</p>

<p><strong>Source Clip</strong> 指定如何处理分离片段的源片段。</p>

<p><strong>Delete Original Source</strong> 在创建两个新的源片段前删除源片段。如果用户确定不再使用整个片段，可以使用这一选项。</p>

<p><strong>Keep Original Source</strong> 在创建两个新的源片段前把源片段放在其原来的位置处。如果以后还会用到整个片段，可以使用这一选项。</p>

<p>在默认状态下，这两个新片段被命名为clipnSourceStartSource 和clipnEndSource。</p>

<p><strong>Split Time</strong> 指定在何处断开片段。</p>

<p><strong>Current Time</strong> 使用时间栏里的当前时间。</p>

<p><strong>Specify Time</strong> 在输入栏里可以输入时间，指定在何处断开片段。
<h6>技巧</h6>
用户不能直接分离一个循环的片段。相反，合并片段（与自身合并）来创建一个不循环的片段，然后分离新的片段。
<h6>合并片段</h6>
用户可以合并两个或多个片段为一个片段。合并的片段可以是同一个轨道上按序排列的片段，也可以是不同轨道上上下排列的片段。
<h6>使用合并轨道的优点：</h6>
用户可以方便的移动、缩放和循环一个合并的片段。</p>

<p>如果用户编辑原始的片段，合并的片段不会受到影响。</p>

<p>如果用户合并一对混合的片段，则得到的源片段包含混合动画的关键帧。用户可以激活合并的片段并在图表编辑器中编辑它的动画。</p>

<p>用户可以合并一个单个的片段为一个片段。这有助于使用相对片段创建一个绝对片段，或分离一个循环的片段（参看上一个主题）。</p>

<p>因为Maya 只能混合一对片段，用户可以合并三个或多个片段为一对片段，然后再混合片段。
<h6>合并片段的操作</h6>
1 选择要合并的片段。</p>

<p>2 在Trax Editor 视窗中选择Edit &gt; Merge 。</p>

<p>3 设置下列选项，并单击Merge Clip 按钮。</p>

<p><strong>Name </strong>指定合并的片段的名称。</p>

<p><strong>Keep originals</strong></p>

<p><strong>in Trax editor </strong>在创建了合并片段后，保留Trax Editor 视窗中的原始片段。如果用户认为以后还会用到原始片段，可以选择这一选项。为了节省内存，关闭此选项。
<h6>混合片段</h6>
用户可以混合角色中两片段的公共属性，从而在片段的运动中创建平滑的过渡。混合有相似运动的片段所得效果为最好。例如用户可以创建角色从走到跑的平滑过渡。混合不同的运动，所得效果可能不会很好，例如，如果对角色从跑到翻跟头两片段进行混合，所得过渡效果会显得很笨拙。混合完片段后，可以编辑混合结果，或重新定位时间栏中的片段，来改变混合的范围。混合的片段可以是不同轨道上重叠的片段，或是一个轨道上先后排列的两个片段，一般是混合部分重叠的片段。如果用户混合两个部分重叠的片段，Maya 只会混合重叠的部分。
<h6>混合片段：</h6>
1 选择要混合的片段。片段中必须有一个或多个共同的属性，否则混合操作会失败。</p>

<p>2 在Trax Editor 视窗中选择Create &gt; Blend</p>

<p>3 设置下列选项，并单击Create Blend 按钮。</p>

<p><strong>Initial Weight Curve </strong>指定在片段的开始、中间和结束处，混合是如何被插值的。</p>

<p><strong>Linear </strong>从片段开始到片段的结束，以恒量速率改变片段的参数值。</p>

<p><strong>Ease In </strong>在片段开始处，缓慢地改变属性的数值，在片段的末端快速地改变属性的数值。</p>

<p><strong>Ease Out </strong>在片段开始处，快速地改变属性的数值，在片段的末端缓慢地改变属性的数值。</p>

<p><strong>Ease In Out </strong>在片段的开始和结束处，缓慢地改变片段的属性数值，在片段的中间处，快速地改变片段的属性数值。</p>

<p>4 对于重叠的片段，在Trax Editor 视窗中对片段的位置做出一些调节，这样动画可以平滑的</p>

<p>从一个片段过渡到另一个片段。
<h6>编辑混合动画：</h6>
1 单击连接两个混合片段的曲线。</p>

<p>2 在Trax 编辑器中，选择View &gt; Graph Anim Curves 命令。</p>

<p>图表编辑器在0—1 的时间范围内显示混合曲线，范围从0—1 代表混合从开始到结束间的范围。Maya 会忽略0—1 外的曲线部分，动画中第一个播放的片段混合进第二个播放的片段中。在片段重叠的第一个帧处，顶部的片段完全（100%）决定了运动，底部的片段对运动毫无影响（0%）。片段重叠处的最后一帧，底部的片段完全控制运动（100%），顶部的片段不会对运动有影响。在播放过程中，随着顶部片段的控制的减少，底部片段的控制会增加。用户可以调整曲线的形体，改变每个片段的控制程度。例如，可以如下改变混合曲线的形状：在混合曲线的开始，顶部片段开始会完全控制运动（100%），在混合曲线的中部，顶部片段控制会减少到0，在混合曲线的末端，顶部片段的控制增加到完全控制运动。底部片段会在混合过程中，也相应地从毫无控制到完全控制再到毫无控制（0%~100%~0%）。如果想向混合曲线中添加关键帧，改变曲线的形体，首先要保证Preference（参数）视窗中的Timeline 设置里的Timeline Snapping 处于关闭状态，否则不能在浮点数值时间上设置关键帧。</p>

<p>如果选择一种某种类型的混合，例如线性，并想把其切换成其它的混合方式，需要删除原混合，并添加新的混合方式。删除混合的方法是：在Trax Eitor 视窗中选择混合，然后按下键盘上的Delete 键即可。如果混合时间栏里两个同时开始的重叠片段，Maya 会使用第一个选中的片段作为混合开始时的完全控制片段。</p>

<p>如果把首先播放的片段移动并定位于第二个播放片段的后面，可能会得到意想不到的混合结果。混合操作趋向于把第一个播放的片段混合到第二个播放的片段中。</p>

<p>如果混合片段得不到理想的过渡效果，需要添加运动扭曲，调整过渡。如果仍不起作用，则需要向过渡中设置关键帧。
<h6>查看并编辑片段的动画曲线</h6>
打开选中片段的图表编辑器，可编辑片段的动画曲线。
<h6>查看和编辑片段的动画曲线作：</h6>
1 选择片段。</p>

<p>2 在Trax Editor 视窗中选择View &gt; Graph Anim Curves。</p>

<p>编辑片段的原始关键帧</p>

<p>要编辑片段的源关键帧时，必须激活片段。如果要使片段回到不可编辑关键帧的状态下，片段必须处于非激活状态。</p>

<p>当激活片段时，Maya 在时间栏的原始位置显示关键帧。（如果在Trax Editor 视窗中，把片段移动到时间栏中不同的位置处，关键帧不会在原始位置处显示。）</p>

<p>当片段处于激活状态时，Maya 不会考虑Weight， Offset Relative 等设置。Maya 会使角色上所有其它的片段无效，使它们的效果不会添加到激活的片段上。</p>

<p>如果在片段中设置新的关键帧，并且关键帧的时间超过源片段的延时，当激活片段时，会播放关键帧，但不会包括在没有激活的片段中，除非在属性编辑器中，修改源片段的延时。
<h6>编辑片段的原始关键帧：</h6>
1 选择片段。</p>

<p>2 在Trax 编辑器中，选择Modify &gt; Activate/Deactivate Clip。则关键帧会显示在时间栏中，此时，用户可以编辑它们。
<h6>废除编辑片段的关键帧的能力：</h6>
1 选择片段。</p>

<p>2 在Trax 编辑器中选择Modify &gt; Activate/Deactivate Clip。时间栏里的关键帧被去除，而且关键帧不能再被编辑。
<h6>使片段有效和失效</h6>
如果要关闭片段，则片段不能再播放。如果要使片段能够重新播放，打开片段。一个有用的动画技术是使用多个片段来创建运动合成，然后通过打开和关闭片段，控制哪个片段起作用。
<h6>使片段失效：</h6>
1 选择起作用的片段。</p>

<p>2 在Trax 编辑器中，选择Modify &gt; Enable/Disable。
<h6>使片段有效：</h6>
1 选择想使其有效的片段。</p>

<p>2 在Trax 编辑器中选择Modify &gt; Enable/Disable。
<h6>添加和删除轨道</h6>
对于选中的角色，可以添加和删除空轨道。如果向一个角色中添加多个轨道，那么可以把几个相似的片段放在同样的时间范围里，这样便于比较各个动画。除要播放的片段外，关闭所有其它的片段，然后播放动画查看此片段的效果。对每个片段都重复此操作。
<h6>添加一个轨道：</h6>
1 选择要添加轨道的角色。</p>

<p>2 在Trax Editor 视窗中选择Modify &gt; Add Track。Maya 在最低的轨道下添加轨道，此最低轨道中应包含选中的角色一个片段。
<h6>删除空轨道；</h6>
1 选择要去除轨道的角色。</p>

<p>2 在Trax 编辑器中，选择Modify &gt; Remove Track 命令。Maya 会去除选择角色的最低空轨道。
<h6>运动扭曲</h6>
用户可以向已有动画片段的角色上设置关键帧，关键帧会影响与片段动画相关的角色。在已有动画上实施动画的技术，被称为非破坏性动画或运动扭曲。在下列情况下，运动扭曲是非常有用的：</p>

<p>l 对某个片段很满意，但想在不破坏已有工作的前提下，对其做些微小的改变。</p>

<p>l 用户已为不同的角色创建了动画片段实例。例如，要创建一队人沿林荫道走路的情景，但想使每个角色都有自己独特的走路姿势。</p>

<p>l 用户已为角色创建了密集的关键帧数据，例如，使用运动捕捉，但又想在不改变关键帧的情况下，调节运动。当用户在角色上设置关键帧时，运动扭曲的范围显示在Trax 编辑器中，这一范围为时间栏中的蓝色区域。</p>

<p>在添加运动扭曲关键帧前，首先在片段中要修改片段的开始和结束处设置关键帧（不要改变属性数值）。这些边界关键帧限定了运动扭曲的始端和末端。然后在划定的范围内设置附加的关键帧，重复播放动画，确保运动扭曲产生需要的效果。当对附加关键帧感到满意时，可以为附加关键帧创建片段，从而可以修改权重，来调整运动。</p>

<p>例如，如果有一个士兵行军的片段，用户对他的大部分动作都很满意，但想使士兵在走路时，把脚再抬高点，首先为一只脚着地的两关键帧设置边界关键帧，不改变任何属性参数。然后，在脚抬起的位置处，把其抬得更高一点，并在此处设置关键帧，创建关键帧的片段，并试着改变权重参数值，调整动画。</p>

<p>如果要在相对片段，包括循环片段，上使用运动扭曲，可能会得到不好的结果，如果为相对或循环片段创建运动扭曲，可以使用Edit &gt; Merge 命令使片段变为绝对片段。
<h5>使用姿势</h5>
动画完角色后，可以保存一张角色当前位置的快照。角色的某一位置的快照称为姿势。姿势可以是时间栏里任一时刻时的动作。用户可以象片段一样在Trax Eitor 视窗中实例、拷贝和粘贴姿势。创建姿势的优点如下：</p>

<p>l 当动画角色时，可以用姿势进行位置的比较。例如，要做一个使角色步行走一圈的动画，需要显示角色走出第一步时的位置，这样才能明确角色应停在何处才算完成了一整圈的行走。</p>

<p>l 用户可以创建角色的姿势，然后使用Blend Shape（融合变形）功能，混合姿势间的动画。例如，如果创建了角色说英语时，它的嘴运动的所有的快照，那么使用Blend Shape 功能，操纵嘴的多个定位，模拟语言。</p>

<p>l 作为主动画师，需要创建长角色动画序列的各种关键帧姿势，而且使自己的合作者能有创建性的使用这些关键帧姿势，动画角色的其它运动。
<h6>创建姿势</h6>
1 选择角色。</p>

<p>2 单击时间栏里的帧。</p>

<p>3 在Trax Editor 视窗中选择Create &gt; Pose ，显示选项视窗。用户可以交互式地使用Maya 的主菜单，选择Animate &gt; Create Pose 。</p>

<p>4 在Name 栏里输入姿势的名称，然后单击Create Pose 按钮。当创建姿势时，Maya 在Visor 视窗中保存姿势。在 Visor 视窗中合适的位置处右键单击，并从弹出菜单中选择Apply Pose 项，可以把角色的姿势定位。</p>

<p>要使角色回到实际的动画位置，重新播放动画，或单击时间栏里的一个帧即可。</p>

<p>在Visor 视窗中，可以用鼠标右键单击片段，选择Apply Pose。这样则不必改变当前的场景时间，就能把角色置于片段的开始位置处。
<h5>输入和输出源片段</h5>
当创建项目时，Maya 创建一个片段目录。如果用户从一个场景中输出一个源片段，Maya把它保存在一个场景文件中，此文件位于项目的Clip 目录中。如果用户输入一个片段到场景中，Maya 把它放在场景的Visor 视窗中。</p>

<p>许多动画师用其它的空场景文件保存动画片段的集合，例如行走和跑步的片段。</p>

<p>Maya 根据节点和属性名称把输入的片段实施到角色上。因此，如果用户创建了一个片段库，使用的名称结构最好能使用户可把片段实施到所有需要实施此片段的角色上。
<h6>从当前场景中输出片段：</h6>
1 选择片段。</p>

<p>2 在Trax 编辑器中选择File &gt; Export Clip。在Visor 视窗中，选择要把片段输入到哪个文件中，选择文件名即可，然后单击Export。
<h6>输入片段：</h6>
1 在Trax 编辑器中，选择File &gt; Import Clip。</p>

<p>2 在文件浏览视窗中，选择包含片段的文件，然后单击Import。在Visor 视窗中，片段列在Unused Clips&amp;Poses 中。</p>

<p>3 使用片段时，用鼠标中键把片段拖拉到Trax Editor 视窗中，或用Trax Editor 中的菜单项目，把片段拷贝粘贴到角色上。
<h5>输出和编辑角色映射</h5>
当把片段从一个角色上拷贝下来，然后粘贴到另一个角色上时，被粘贴的角色的属性可能不能像预料的那样动画。例如，本应该是脚做旋转运动，结果变成了脖子做旋转运动了。如果发生了这种问题，可能是因为所用的属性动画或被粘贴的角色的物体和属性与原物体不同。如果要修改映射，使角色的动作与原角色相同，必须输出角色映射，并编辑它的错误的属性映射。
<h6>输出角色映射并修改映射</h6>
1 删除或取消片段的粘贴操作。</p>

<p>2 选择两个角色。</p>

<p>3 在Trax 编辑器中选择File &gt; Export Character Map 。</p>

<p>4 设置下列选项：</p>

<p><strong>Map Method </strong>指定如何格式化映射。</p>

<p><strong>By Attribute Name </strong>使用By Attribute Name 选项所创建的映射，把拷贝的角色的属性参数值映射于另一角色相应的属性名下。</p>

<p><strong>By Attribute Order</strong> 使用By Attribute Order 选项所创建的映射，根据通道栏中属性的递减顺序，把拷贝的角色的属性参数值粘贴于另一角色上。</p>

<p><strong>By Node Name</strong> 使用By Node Name 选项所创建的映射，把拷贝的角色的属性参数值映射于另一角色相应的物体和属性名下。</p>

<p><strong>By Current Map</strong> 只有输出角色映射并按以下所述步骤操作，此选项才有用。使用此选项可以为选择有角色创建一个带有当前映射的映射。如果已输出了一个映射，这个映射需要修改，然后向映射中添加新属性，这时这一选项是非常有用的。使用这一选项可以编辑更少的属性映射——只编辑修改映射后又添加上的属性。</p>

<p>5 单击Export 按钮。</p>

<p>显示文件浏览视窗。</p>

<p>6 在文件浏览器中，指定文件名和loginname/maya/scripts 目录作为输出角色映射的地点，然后单击Write。角色映射是.mel 文件。</p>

<p>7 打开带有文本编辑器的脚本，修改属性映射。编辑文件的结构在文件中。</p>

<p>8 在脚本编辑器中，选择File &gt; Source Script。然后在脚本编辑器中输入脚本名，并在单击数字键区的回车键。</p>

<p>9 对片段进行拷贝、粘贴操作，只是需选择Edit &gt; Paste ，并把粘贴方法设置为By Current Map。</p>

<p>10 最后，播放动画，检测结果。
<h5>输入参考片段</h5>
当用户输出一个片段时，它会保存在一个场景文件，但是不会连接到任何角色上。它实质上片段控制属性的动画曲线的集合。如果用户输入以前输出的片段，用户不能使用By Current Map 选项来拈贴它。但用户可通过参考包含输入片段的场景来解决这个问题。
<h6>通过参考的方式输入片段：</h6>
1 打开包含目的角色的文件，所谓目的角色就是要使用输入片段的角色。</p>

<p>2 参考含有源角色的文件，所谓源角色是具有输入片段的文件。</p>

<p>3 打开Trax 编辑器，并把片段从源角色上拷贝粘贴到目的角色上。</p>

<p>4 选择File &gt; Reference Editor。</p>

<p>5 在参考编辑器中选择参考，然后选择Edit &gt; Remove Reference。</p>

<p>这一程序非常适用于输入含有场景的角色，因为删除参考会删除所有源角色场景要素。在场景中不会有没用的、额外的节点。</p>

<p>用户可以为此过程创建MEL 命令，向片段中输入各种运动捕捉数据。
<h5>理解Visor 视窗中的片段和姿势</h5>
Visor 中的Animation 部分显示了场景中的源片段。当决定是否输入、输出、或把片段从一个角色上拷贝、粘贴到另一个角色上时，则需要Visor 中的这些片段。要从Trax 编辑器中打开Visor，选择File &gt; Visor 命令。</p>

<p>有两个文件夹与片段有关，这两个文件夹是Character(s) Clips &amp; Poses 和 Unused Clips &amp;Poses。对于一个当前选中的角色，在Character（s）Clip&amp; Poses 下的Clip 文件夹包含此选中角色的源片段。如果当前没有选中角色，则它包含场景中所有角色的源片段。</p>

<p>在Unused Clips &amp; Poses 下的Clip 文件夹中包含当前场景中没被任何角色使用的源片段。例如，如果从其它场景中输入一个片段到此处，它会存储在此处。如果把它粘贴到一个角色上，它仍然会显示在Unused Clips&amp; Poses 文件夹中，但Maya 会在角色上添加一个额外的备份。</p>

<p>姿势是用户所创建的角色的某一运动定位的快照。</p>

<p>如果选择一个角色作为当前角色，则在Character(s) Clips &amp; Poses 下的姿势文件夹只包含这个角色的姿势。如果没有当前角色，此文件夹包括场景中所有角色的姿势。Unused Clips &amp;Poses 下的姿势文件夹里包含不属于场景中任一角色的姿势。
<h5>使用子角色</h5>
子角色束缚与角色相关的属性，这样用户可以协调地为其设置关键帧。当为角色设置关键帧时，也会为所有的子角色设置关键帧。当使用Relative offset 创建一个片段，而且使用Absolute offset 为同一角色创建另一片段时，就会用到子角色。</p>

<p>例如，假设动画角色走路的过程，角色的根部在向前行进的同时，胳膊和腿都旋转。假设把根部创建为主角色，腿和胳膊为子角色，可以为整个角色设置片段，主角色片段使用相对属性，子角色片段使用绝对属性。
<h6>使用具有子角色的角色上的片段</h6>
当创建片段时，如果打开Include Subcharacters in Clip，Maya 创建包括角色的所有动画曲线和子角色的单个源片段。在Visor 中，可以用鼠标中键拖拉片段，把其放置到合适的轨道上，可以把实例化片段使用到单个子角色或整个角色上。</p>

<p>当用子角色数据把源片段拷贝到新角色上时，首先输入能够建立两角色和两角色的子角色间关系的角色映射。然后用By Current Map 选项把源片段粘贴到角色和它的子角色上。
<h6>使用子角色上的片段</h6>
当为单个子角色创建只含动画曲线的源片段时，需要把当前角色设置为子角色并创建片段。源片段只能用于一个子角色上，因此不能把同一片段实例化，使用于多个子角色上。当统一地动画几个角色时，必须把片段从一个角色上拷贝粘贴到另一个角色上。
<h6>在具有片段的角色上创建子角色</h6>
如果在具有片段的角色上创建子角色，子角色会继承源片段，因此不会丢失动画。
<h5>制作奔跑与跳跃连接的动画</h5>
实例教程
<h6>1 创建奔跑动画的片段</h6>
打开场景文件run.mb，将角色集设置为man，如图6.2.2所示。</p>

<p><a title="image003" href="http://www.flickr.com/photos/95019520@N00/2351535393/" target="_blank"><img src="http://static.flickr.com/3223/2351535393_54a4f94ac0.jpg" border="0" alt="image003" /></a>图6.2.2</p>

<p>选择Animate&gt;Create Clip命令选项，打开选项窗口，输入片段的名称，参数设置如图6.2.3所示。</p>

<p><a title="image004" href="http://www.flickr.com/photos/95019520@N00/2352363586/" target="_blank"><img src="http://static.flickr.com/2100/2352363586_b5456fd03d.jpg" border="0" alt="image004" /></a>图6.2.3
<h6>2 输出奔跑动画的片段</h6>
选择Windows&gt;Animation Editors&gt;Trax Editor命令，打开Trax Editor，点击Load Selected Characters按钮<a title="image006" href="http://www.flickr.com/photos/95019520@N00/2352363372/" target="_blank"><img src="http://static.flickr.com/2159/2352363372_99a54db378.jpg" border="0" alt="image006" /></a>，显示动画片段。由于man角色集有两个子角色集leg和body，因此分别创建两个片段，如图6.2.4所示。</p>

<p><a title="image007" href="http://www.flickr.com/photos/95019520@N00/2352365236/" target="_blank"><img src="http://static.flickr.com/3069/2352365236_88dc119d2f.jpg" border="0" alt="image007" /></a></p>

<p>图6.2.4</p>

<p>选中两个片段，选择File&gt;Export Clip命令。输出片段选择.ma格式，命名为run_clip。保存当前文件。
<h6>3 创建跳跃动画的片段</h6>
打开场景文件jump.mb，将角色集设置为man。选择Animate&gt;Create Clip命令选项，打开选项窗口，输入片段的名称，参数设置如图6.2.5所示。由于整个动画的第13帧是跳跃动作的起始姿态，而且这个姿态与奔跑动作片段的结束姿态非常相似，因此需要手动设置创建片段的起始与结束帧。</p>

<p><a title="image009" href="http://www.flickr.com/photos/95019520@N00/2352365012/" target="_blank"><img src="http://static.flickr.com/3052/2352365012_e780c1e77d.jpg" border="0" alt="image009" /></a>图6.2.5
<h6>4 输出跳跃动画的片段</h6>
选择Windows&gt;Animation Editors&gt;Trax Editor命令，打开Trax Editor，点击Load Selected Characters按钮<a title="image006" href="http://www.flickr.com/photos/95019520@N00/2352363372/" target="_blank"><img src="http://static.flickr.com/2159/2352363372_99a54db378.jpg" border="0" alt="image006" /></a>，显示动画片段。由于man角色集有两个子角色集leg和body，因此分别创建两个片段。选中两个片段，如图6.2.6所示。选择File&gt;Export Clip命令。输出片段选择.ma格式，命名为jump_clip。</p>

<p><a title="image010" href="http://www.flickr.com/photos/95019520@N00/2351536639/" target="_blank"><img src="http://static.flickr.com/2211/2351536639_dfe8b4345f.jpg" border="0" alt="image010" /></a>图6.2.6
<h6>5 连接奔跑与跳跃的动作</h6>
打开创建了片段的run.mb，将角色集设置为man。打开Trax Editor，点击Load Selected Characters按钮<a title="image006" href="http://www.flickr.com/photos/95019520@N00/2352363372/" target="_blank"><img src="http://static.flickr.com/2159/2352363372_99a54db378.jpg" border="0" alt="image006" /></a>，显示动画片段。选择File&gt;Import Clip to Characters命令，选择jump_clip.ma文件。导入跳跃动作的片段，如图6.2.7所示。</p>

<p><a title="image012" href="http://www.flickr.com/photos/95019520@N00/2352364672/" target="_blank"><img src="http://static.flickr.com/2035/2352364672_b7d2aa1b6c.jpg" border="0" alt="image012" /></a></p>

<p>图6.2.7</p>

<p>调整跳跃动作片段的位置，接到run片段的后面，如图6.2.8所示。播放动画，角色在奔跑之后很顺畅地连接了跳跃的动作。</p>

<p><a title="image014" href="http://www.flickr.com/photos/95019520@N00/2351536141/" target="_blank"><img src="http://static.flickr.com/2003/2351536141_1a8ed0cac4.jpg" border="0" alt="image014" /></a></p>

<p>图6.2.8
<h6>6 设置奔跑片段的参数</h6>
分别选中run1和run4片段，在通道栏中设置postCycle属性为5，将Scale属性设置为0.8，如图6.2.9所示。</p>

<p><a title="image016" href="http://www.flickr.com/photos/95019520@N00/2352364118/" target="_blank"><img src="http://static.flickr.com/3075/2352364118_6b448fd780.jpg" border="0" alt="image016" /></a>图6.2.9</p>

<p>重新调整跳跃动作片段的位置，如图6.2.10所示。</p>

<p><a title="image017" href="http://www.flickr.com/photos/95019520@N00/2351535845/" target="_blank"><img src="http://static.flickr.com/3049/2351535845_d66b926a6b.jpg" border="0" alt="image017" /></a>图6.2.10</p>

<p>播放动画，角色奔跑速度加快了，距离变长了。</p>
